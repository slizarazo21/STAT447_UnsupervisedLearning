setwd('/Users/simonlizarazo/Dropbox/UIUC/Coursework/2023/Fall/STAT 437/Project/')
data = read.delim('ATAC_TCGA_rawcounts_compilation_Downgraded_FINAL.txt', sep = ',')
library(dominatR)
View(data)
data_norm = quant.normalization(data[,-1], log_trans = T)
data_norm = data_norm |> as.data.frame()
data_norm$V1 = data$V1
data_norm = data_norm |> relocate(V1)
library(tidyverse)
data_norm = data_norm |> relocate(V1)
View(data_norm)
pol3_genes = read.delim('POLIII_Transcriptome_Coordenates_FINAL.bed', sep = '\t')
View(pol3_genes)
pol3_genes = read.delim('POLIII_Transcriptome_Coordenates_FINAL.bed', sep = '\t', header = F)
data_norm = data_norm |> separate(V1, into = c('V1', 'V2', 'V3'), sep = '\\&&')
data_norm = data_norm[data_norm$V3 %in% pol3_genes$V7,]
pol3_genes = pol3_genes |> select(V4,V7, V8)
data_norm = data_norm |> left_join(pol3_genes, join_by('V3' == 'V7'))
pol3_genes$V7 = as.character(pol3_genes$V7)
data_norm = data_norm |> left_join(pol3_genes, join_by('V3' == 'V7'))
View(pol3_genes)
View(data_norm)
data_norm = data_norm |> relocate(V4, V8)
View(data_norm)
data_norm = data_norm |> select(-V4, -V1, -V3)
View(data_norm)
View(pol3_genes)
write.csv(data_norm, 'pol3_tcga_count_norm.csv', col.names = T)
write.csv(data_norm, 'pol3_tcga_count_norm.csv', col.names = T, row.names = T)
data = read.delim('ATAC_TCGA_rawcounts_compilation_Downgraded_FINAL.txt', sep = ',')
data_norm = data_norm |> as.data.frame()
data_norm$V1 = data$V1
pol3_genes = read.delim('entropy_pol3_tissues_ALL_normalized_by_global_tissue.txt', sep = ',')
View(pol3_genes)
pol3_genes = pol3_genes |> filter(core_type != 'Innactive')
data_norm = data_norm |> separate(V1, into = c('V1', 'V2', 'V3'), sep = '\\&&')
data_norm = data
data_norm = data_norm |> separate(V1, into = c('V1', 'V2', 'V3'), sep = '\\&&')
data_norm = data_norm[data_norm$V3 %in% pol3_genes$V7,]
pol3_genes$V7 = as.character(pol3_genes$V7)
pol3_genes = pol3_genes |> select(V7, V8)
pol3_genes$V7 = as.character(pol3_genes$V7)
data_norm = data_norm |> left_join(pol3_genes, join_by('V3' == 'V7'))
data_norm = data_norm |> relocate(V8)
data_norm = data_norm |> select( -V1, -V3)
write.csv(data_norm, 'pol3_tcga_count_norm.csv', col.names = T, row.names = T)
data = read.delim('ATAC_TCGA_Compilation_pValue_Gene_Downgraded_FINAL.txt', sep = ',')
data_norm = data
data_norm = data_norm |> separate(V1, into = c('V1', 'V2', 'V3'), sep = '\\&&')
data_norm = data_norm[data_norm$V3 %in% pol3_genes$V7,]
pol3_genes$V7 = as.character(pol3_genes$V7)
data_norm = data_norm |> left_join(pol3_genes, join_by('V3' == 'V7'))
data_norm = data_norm |> relocate(V8)
data_norm = data_norm |> select( -V1, -V3)
write.csv(data_norm, 'pol3_tcga_count_norm.csv', col.names = T, row.names = T)
